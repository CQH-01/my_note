内容整理自  【[C语言中文网](http://c.biancheng.net/)】-- 【[Linux vi命令](http://c.biancheng.net/vi/)】

---



#### vi三模式

***

vi默认命令行模式，按 a / i / o 进入文本编辑模式

任何模式按 esc 将进入命令行模式

命令行模式按 ： 进入末行模式

---

进入 vi 后，光标处于文件中特定的某行上，可在 vi 命令上加上行号和文件名，其格式如下：

```
vi +行号 文件名
```

vi 编辑器支持模式匹配，也就是说用户可以在命令中指定一个模式串。之后进入 vi 后，光标就处于文件中第一个与指定模式串相匹配的那行上。其格式如下：

```
vi +/模式字符串 文件名
vi +/main 文件名   ##停在main这行
```

使用 vi 可以同时编辑多个文件，只要在进入 vi 的命令中写入所要操作的文件即可，还可以使用通配符，其格式如下：

```
vi 需要打开文件的通配符
```

如果需要打开当前目录下所有的C语言源文件，则可以使用以下命令：

```
$ vi *.c
```

---

**插入文本命令：i 和 I**

小写为当前位置前插入，大写为当前行首插入

**追加文本命令：a 和 A**

小写为当前位置后追加，大写为当前行末追加

**空行插入命令：o 和 O**

小写为当前位置下插入空行，大写为当前上插入空行

+++

**vi文本删除**

| 文本删除命令 | 命令的意义                          | 文本删除命令 | 命令的意义                   |
| ------------ | ------------------------------------- | ------------ | ---------------------------- |
| x            | 删除光标处的字符                      | d(           | 删除到上一句开始的所有字符   |
| X            | 删除光标前面的字符                    | d)           | 删除到下一句开始的所有字符   |
| dd           | 删除光标所在的整行                    | d{           | 删除到上一段开始的所有字符   |
| D 或 d$      | 删除从光标所在处开始到行尾 的内容     | d}           | 删除到下一段开始的所有字符   |
| d0           | 删除从光标前一个字符开始到 行首的内容 | d<CR>        | 删除包括当前行在内的两行字符 |
| dw           | 删除一个单词                          |              |                              |

**vi复制粘贴**

| 文本复制命令 | 命令的意义                           | 文本复制命令 | 命令的意义                   |
| ------------ | ------------------------------------ | ------------ | ---------------------------- |
| yy           | 复制光标所在的整行                   | y{           | 复制到上一段的开始           |
| Y 或 y$      | 复制从光标所在处开始到行尾的内容     | y}           | 复制到下一段的开始           |
| y0           | 复制从光标前一个字符开始到行首的内容 | y<CR>        | 复制包括当前行在内的两行内容 |
| y(           | 复制到上一句的开始                   | yw           | 复制一个单词                 |
| y)           | 复制到下一句的开始                   |              |                              |

- p 命令粘贴：粘贴命令，粘贴当前缓冲区中的内容

- v 命令选中：在命令模式下进行文本选择。在需要选择的文本的起始处按下 v 键进入块选择模式，然后移动光标到块尾处。这之间的部分被高亮显示，表示被选中。

- V 命令选中：在命令模式下按行进行文本选择。在需要选择的文本的第一行按下 V 键，然后移动光标到块的最后一行。这之间的所有行被高亮显示，表示被选中。

- u 命令撤销：该命令撤销上一次所做的操作。多次使用 u 命令会一步一步依次撤销之前做过的操作（在一次切换到文本输入模式中输入的所有文本算一次操作）。

- U 命令撤销：该命令会一次性撤销自上次移动到当前行以来做过的所有操作，再使用一次 U 命令则撤销之前的 U 命令所做的操作，恢复被撤销的内容。

- `.`重复操作：当用户在文本编辑中碰到需要机械地重复一些操作的时候，重复命令就派上了用场。它可以让用户方便地再执行一次前面刚完成的某个复杂的命令。重复命令**只能在命令模式下工作**，在该模式下按下`.`键即可。

- r命令替换：该命令将当前光标所指的字符替换为提供的字符。可以在该命令之前加上数字 n，表示将从当前字符开始的 n 个字符替换为提供的字符。

- R命令替换：该命令会让 vi 进入 replace 模式。在此模式下，每个输入的字符都会替换当前光标下的字符，直到输入 <Esc> 结束该模式。

- 末行模式退出

  | 命令       | 描述 |
  | ----- | ---- |
  | q          | 退出时当前编辑文件尚未保存，则 vi 并不退出 |
  | q!         | 不论文件是否改变都会强行退出 vi 编辑器 |
  | w 新文件名 | 保存,使用时可以再给当前编辑文件起一个新的文件名,相当于另存为 |
  | w!    | 覆盖保存                                                     |
  | wq         | 先保存文件，然后退出 vi |
  | x          | 若当前编辑文件曾被修改过，则 vi 会保存该文件。否则 vi 直接退出，不保存该文件 |

- 光标移动

  | 光标移动命令 | 命令意义                     | 光标移动命令 | 命令意义                       |
  | ------------ | ---------------------------- | ------------ | ------------------------------ |
  | h            | 光标左移一个字符             | k            | 光标上移一行                   |
  | j            | 光标下移一行                 | l            | 光标右移一个字符               |
  |**行移动**||||
  | 4H           | 移至当前屏幕的第 4 行        | M            | 移至屏幕显示文件的中间行的行首 |
  | L            | 移至屏幕显示文件最底行的行首 | 5G           | 移至整个文件第5行行首          |
  |**字移动**||||
  | w            | 光标右移一个字               | W            | 光标跳空格右移一个字           |
  | e            | 光标移到本字字尾             | E            | 光标跳空格移到本字字尾         |
  | b            | 光标移至本字字首             | B            | 光标跳空格移至本字字首         |
  |**段移动**||||
  | {            | 光标向前移至上一个段落的开头 | }            | 光标向后移至下一个段落的开头   |
  |**文本行移动**||||
  | >n         | 指定行向右移动，通常是右移 8空格,共n行向右移动8格，本行不算在n内 | <            | 与>n相反 |
  | n>>         | 指定行向右移动，通常是右移 8 空格,共n行向右移动8格，本行算在n内  | <<          | 与n>>相反   |
  |**文本跨行移动**||||
  | imj         | 把第 i 行移至第 j 行的下方 |              |                                |
  | **滚屏**         |                                    |              |                                |
  | Ctrl+u       | 将屏幕向前文件头翻滚半屏             | Ctrl+d     | 将屏幕向后文件尾翻滚半屏 |
  | Ctrl+f        | 将屏幕向文件尾方向翻滚一整屏     | Ctrl+b    | 将屏幕向文件首方向翻滚一整屏    |
  |**字符串检索**|**末行模式**|||
  | /string      | 从光标处开始向后寻找字符串 string | ？string      | 从光标处开始向前寻找字符串 string |
  | n            | 重复上一条检索命令        | N           | 重复上一条检索命令，但检索方向改变 |
  | g/string     | 使光标停止在第一个检索到的 string 串的行首 |             |                    |

---


vi 编辑器提供简单的字符串替换命令，在**末行模式**下可以使用替换命令，其命令格式如下：

[range]s/s1/s2/ [option]

- [range] 表示检索范围，省略时表示当前行。下面是一些检索范围的例子。

  - `1,10`表示从第 1 行到 10 行。
  - `%`表示整个文件，同`1, $`。
  - `. ,$`从当前行到文件尾。

- s 为替换命令。

- s1 要被替换的串，s2 为替换的串。

- option 表示选项：

  - `/g`表示在全局文件中进行替换。

  - `/c`表示在每次替换之前需要用户进行确认。

  - 省略时仅对每行第一个匹配串进行替换

```shell
10,22s/printf/PRINT/g 	 ## 将第 10~22 行的 printf 标识符替换为 PRINT
```


vi 编辑器在执行替换命令指令时，可以进行简单的模式匹配，其匹配模式如下：

```
\<word
```

替换以 word 开始的单词的 word 部分。例如：

```shell
%s/\<abc/cde 	##表示将以 abc 开头的单词替换为以 cde 开头
```



#### vi窗口切分命令（split命令)

---

在**末行模式**中，输入 split 命令即可实现窗口的切分，其命令格式如下：

: split文件名

> 其中`:`表示进入末行模式。

split 也可简写为 sp。这时窗口切分为上下两部分，下半部分对应原来的文件，上半部分对应新打开的文件。

有时用户需要在多窗口之间进行切换，vi 编辑器提供一组命令支持用户切换多个窗口，其命令如下表所示。



| 切换命令       | 命令的意义               |
| -------------- | ------------------------ |
| Ctrl+w，然后 j | 移动光标到下面的一个窗口 |
| Ctrl+w，然后 k | 移动光标到上面的一个窗口 |
| Ctrl+w，然后 q | 关闭当前窗口             |
| Ctrl+w，然后 w | 移动光标到另一个窗口     |

 

####  vi属性设置命令

---

**ps : 在末行模式下输入**

**行号设置命令**

```shell
:set nu (nonu)
```

该命令显示行号（或者不显示行号）。

**显示设置命令**

```shell
:set hlsearch (nohlsearch)
```

该命令设定搜寻字符串反白显示（或者不反白显示）。

**语法缩进命令**

```shell
:set autoindent
```
该命令显示程序语法自动缩进。

**文件存储命令**

```shell
:set backup(nobackup)
```
该命令自动储存备份文件（或者不自动备份文件）。

**显示选项命令**

```shell
:set all
```
该命令显示所有的选项。

**语法高亮命令**

```shell
:syntax on (off)
```
该命令实现程序语法高亮显示（或者不高亮显示）。

**大小写区分命令**

```shell
:set ignorecase(noignorecase)
```

该命令忽略大小写（或者区分大小写）。